!!!
html
  head
    title= title
    link(rel='stylesheet', href='/stylesheets/style.css')
  body
    p Welcome to #{title}
    - if (user)
      p(id='signin') Welcome #{user}
    - else
      p(id='signin') Would you like to sign in? 
        a(id='twitter', href='/twitter') 
          img(src='/images/sign-in-with-twitter-l.png', alt='Sign in with twitter')
        img(id='browserid', src='/images/sign_in_green.png', alt='Sign in with BrowserID')
    script(type="text/javascript", src='/javascripts/jquery-1.6.4.min.js')    
    div!=body
    script(src='https://browserid.org/include.js', type='text/javascript')
    script
      $(document).ready(function(){
        $('#browserid').click(function(){
          navigator.id.getVerifiedEmail(function(assertion) {
            if (assertion) {
              $.post('/browserid', {assertion: assertion}, function(data){
                var parsedData = data;
                if (parsedData.result === 'success'){
                  $('#twitter').hide();
                  $('#browserid').hide();
                  $('#signin').text("Welcome " + parsedData.email);
                }
              });

            } else {
              //TODO(David) Have a clean error message to say we can do the comms
            }
          });
        });
      });
    script
      var uvOptions = {};
      (function() {
        var uv = document.createElement('script'); uv.type = 'text/javascript'; uv.async = true;
        uv.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'widget.uservoice.com/CuWYPnn8a68maGDHls9pxg.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(uv, s);
      })();
    
      
    
